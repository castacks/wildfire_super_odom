session_name: subt_localization

suppress_history: false

start_directory: .

windows:
  - window_name: core
    focus: false
    layout: tiled
    panes:
      - shell_command:
        - cat passwd | sudo --stdin -E bash docker_start.bash
        - sudo docker exec --privileged -it super_odom bash
        - roscore
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - source /root/subt_ws/devel/setup.bash
        - roslaunch --wait velodyne_pointcloud VLP16_points.launch
  - window_name: nodes
    focus: true
    layout: tiled
    panes:
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - source /root/subt_ws/devel/setup.bash
        - roslaunch --wait super_odometry ugv_offline.launch
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - source /root/subt_ws/devel/setup.bash
        - roslaunch --wait vins_estimator cam1_debug.launch
      - shell_command:
        - sleep 30
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -e DATA_PATH=${DATA_PATH} -e NAMESPACE=${NAMESPACE} -e START_TIME=${START_TIME} -e PLAY_DURATION=${PLAY_DURATION} -it super_odom bash
        - cd ${DATA_PATH}
        - rosbag play *.bag --clock --topic ${NAMESPACE}/camera_1/image_raw /thermal/image ${NAMESPACE}/imu/data ${NAMESPACE}/velodyne_packets ${NAMESPACE}/camera_1/image_raw:=/camera_1/image_raw ${NAMESPACE}/imu/data:=/imu/data ${NAMESPACE}/velodyne_packets:=/velodyne_packets -s ${START_TIME} --duration ${PLAY_DURATION}
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - source /root/subt_ws/devel/setup.bash
        - rosrun super_odometry commander_node
  - window_name: misc
    focus: false
    layout: tiled
    panes:
      - shell_command:
        - sleep ${DURATION}
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - sleep 1
        - rostopic pub -1 /savemap_command std_msgs/Bool true
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -e DURATION=${DURATION} -it super_odom bash
        - cd ${RESULT_PATH}
        - sleep 9
        - rosbag record --duration=${DURATION} /uncertainty_X /uncertainty_Y /uncertainty_Z /uncertainty_pitch /uncertainty_roll /uncertainty_yaw /super_odometry_stats /prediction_source /velodyne_points /velodyne_points /camera_1/image_raw /imu/data /tf /velodyne_cloud_registered_imu /super_odometry_stats /prediction_source /aft_mapped_to_init_imu /integrated_to_init /accel_bias /gyro_bias
      - shell_command:
        - sleep 1
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - cd /root/subt_ws
        - source devel/setup.bash
      - shell_command:
        - cat passwd | sudo --stdin whoami
        - docker exec --privileged -it super_odom bash
        - sleep 35
        - rviz -d /root/subt_ws/src/subt_state_estimation/subt_ground.rviz
